題目: https://ctf2025.hitcon.org/dashboard/#19

解答: https://reurl.cc/pY2Ej8

這個程式把你傳來的資料偷偷送到同一台電腦上的某些網路埠（port），如果那個內部服務把你送的資料「原封不動地回傳」，程式會把回傳的內容當作 PHP 程式碼執行。結果只要回傳一段會讀 /flag 的程式碼，就能直接看到 flag（比賽答案）。

為什麼會有問題？（用比喻）

想像有個郵差（程式）把你寫的一張紙轉交給同一棟大樓裡的某間辦公室（內網服務）——如果那間辦公室把紙條直接回寄給郵差，郵差就會當那張紙是「可以執行的命令」，然後去做上面寫的事。問題是郵差完全不檢查紙上寫的是不是安全的命令，直接照做 → 這就很危險！

會發生的事（步驟）

你對網站傳送一行資料（HTTP 請求 body），裡面放一段 JSON（也就是一行文字格式）。

網站會把這一行資料送給本機的一些連續埠（例如從 1000 到 1042）。

如果有其中一個埠上有一個「Echo 服務」（會把收到的內容原樣回傳），那個服務就會把你送的那行資料回傳給網站。

網站收到回傳後把它解析成 JSON，看到 signal == "Arrival" 時，就會拿裡面的 logogram 當作 PHP 程式碼執行（eval()），例如 readfile('/flag');，就會把 flag 顯示出來。

攻擊要點

這個漏洞的關鍵是：「把外面傳進來的東西送進內網，內網把它回傳，然後把回傳直接當程式碼執行」。

因為程式會試 probe 到 probe+42 共 43 個埠，所以只要以步長 43 掃遍所有可能的起點，一定會碰到那個有 echo 的埠。

把一段「會被當作 PHP 執行」的文字送到目標，並嘗試用一種聰明的步長（43）掃遍所有內網埠範圍，搭配多執行緒同時嘗試，快速找出能把我們送去內網並回顯的服務，然後讓伺服器執行 readfile('/flag') 把 flag 印出來。

重要技術點：單行 JSON + 換行（對方用 fgets()）、步長 43（覆蓋 probe..probe+42 區塊）、並行請求（加速）。
